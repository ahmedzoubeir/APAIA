Question,Option A,Option B,Option C,Option D,Correct Answer,Explanation
What MITRE ATT&CK technique utilizes WMI event subscriptions to establish persistence and trigger malicious code execution?,T1055.002 - Command and Scripting Interpreter,T1059.004 - Windows Management Instrumentation,T1547.001 - Event Triggered Execution,T1068.003 - Exploitation for Client Execution,C,T1547.001 - Event Triggered Execution utilizes WMI event subscriptions to trigger malicious code execution upon specific events, such as user login or system startup.
What is a common indicator of a potential malicious WMI event subscription on a Windows system?,The presence of mofcomp.exe in the system's startup folder,A new WMI event subscription being created with the name "hard_disk_stat",A modified MOF file being found outside the HKLM\SOFTWARE\Microsoft\WBEM folder,A suspicious process spawned from the WMI Provider Host (WmiPrvSe.exe),C,Modified MOF files are often used to create malicious WMI event subscriptions and are typically found outside the standard WBEM folder.
Which of these is NOT a recommended mitigation strategy to prevent the abuse of WMI event subscriptions for persistence?,Restricting remote access to WMI to only authorized administrators,Implementing Attack Surface Reduction (ASR) rules on Windows 10,Enabling Windows Defender Application Control (WDAC) to block unauthorized WMI scripts,Monitoring WMI event subscriptions for suspicious changes,C,While WDAC can restrict the execution of unauthorized applications, it doesn't directly address the abuse of WMI for persistence. Other options are valid mitigations against WMI-based persistence.
What is a common technique used by adversaries to compile malicious MOF files into WMI event subscriptions?,Using the "mofcomp.exe" utility,Modifying the registry key "HKLM\SOFTWARE\Microsoft\WBEM",Leveraging the "wmic" command-line tool,Employing a custom PowerShell script to create WMI subscriptions,A,Adversaries often utilize "mofcomp.exe" to compile malicious MOF files into WMI event subscriptions that can trigger malicious code.
What is a common approach for detecting potential WMI-based persistence attempts?,Monitoring the execution of mofcomp.exe as a child process of a suspicious utility like PowerShell or CMD,Monitoring the creation of new WMI EventFilter, EventConsumer, and FilterToConsumerBinding events,Analyzing Windows event logs for Event ID 4688,All of the above,D,All options are valid approaches for detecting potential WMI-based persistence attempts. Monitoring "mofcomp.exe" execution, tracking WMI event creation, and examining event logs are all effective methods.
Which of the following is a reliable indicator of potential WMI-based persistence based on event logs?,Windows Event ID 4688 with a parent process name of "WmiPrvSe.exe",Sysmon Event ID 1 with a parent process name of "mofcomp.exe",Windows Event ID 5861 with a suspicious event filter description,Windows Event ID 4624 (Account Logon) with a successful logon from the "WMI" service,A,Windows Event ID 4688 (A new process has been created) with a parent process name of "WmiPrvSe.exe" is a strong indicator of a process spawned by a WMI event subscription, suggesting potential persistence.
What is a common tool that can be used to monitor WMI changes and detect potential persistence attempts?,Sysinternals Autoruns,Microsoft Defender for Endpoint,Process Explorer,Windows Security Center,A,Sysinternals Autoruns is a popular tool used to detect changes to WMI configurations, including potential persistence attempts through WMI event subscriptions.
Which of these tools or techniques can be used to monitor for suspicious activity related to WMI event subscriptions?,Analyzing Windows event logs for event IDs related to WMI events,Utilizing security information and event management (SIEM) tools to correlate WMI-related events,Monitoring the execution of "mofcomp.exe",All of the above,D,All of the mentioned options are valuable techniques for monitoring suspicious activity related to WMI event subscriptions. Event log analysis, SIEM correlation, and "mofcomp.exe" monitoring all contribute to effective threat detection.
Which of the following is a key principle for mitigating the risk of WMI-based persistence?,Preventing credential overlap across systems for privileged accounts,Implementing multi-factor authentication for all users,Restricting network access to the WMI service,Disabling WMI on all systems except for essential services,A,Preventing credential overlap across systems helps limit the impact of a compromise, as attackers cannot easily leverage stolen credentials from one system to gain access to others.
What is the name of the PowerShell cmdlet that can be used to register a WMI event subscription?,Register-WmiEvent,Set-WmiEvent,New-WmiEvent,Get-WmiEvent,A,The "Register-WmiEvent" PowerShell cmdlet is specifically designed to create WMI event subscriptions, making it a potential target for monitoring suspicious activity. 
